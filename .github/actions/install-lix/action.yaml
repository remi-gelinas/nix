name: Install Lix

runs:
  using: "composite"
  steps:
    - name: Get system for installer URL
      shell: bash
      id: get-system
      run: |
        bash --version
        declare -rA system_matrix=( \
          ["Linux_X64"]="x86_64-linux" \
          ["Linux_ARM64"]="aarch64-linux" \
          ["macOS_X64"]="x86_64-darwin" \
          ["macOS_ARM64"]="aarch64-darwin" \
        )

        runner="${RUNNER_OS}_${RUNNER_ARCH}"
        system=${system_matrix["$runner"]}

        echo "system=$system" >> "$GITHUB_OUTPUT"
    - uses: DeterminateSystems/nix-installer-action@v13
      with:
        source-url: https://install.lix.systems/lix/lix-installer-${{ steps.get-system.outputs.system }}
        diagnostic-endpoint: ""
